<!-- <script type="text/javascript" src="library/lib/axios/dist/axios.standalone.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/rollups/hmac-sha256.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/rollups/sha256.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/components/hmac.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/components/enc-base64.js"></script>
<script type="text/javascript" src="library/lib/url-template/url-template.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/sigV4Client.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/apiGatewayClient.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/simpleHttpClient.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/utils.js"></script>
<script type="text/javascript" src="library/apigClient.js"></script>
-->
<script type="text/javascript" src="library/lib/axios/dist/axios.standalone.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/rollups/hmac-sha256.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/rollups/sha256.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/components/hmac.js"></script>
<script type="text/javascript" src="library/lib/CryptoJS/components/enc-base64.js"></script>
<script type="text/javascript" src="library/lib/url-template/url-template.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/sigV4Client.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/apiGatewayClient.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/simpleHttpClient.js"></script>
<script type="text/javascript" src="library/lib/apiGatewayCore/utils.js"></script>
<script type="text/javascript" src="library/apigClient.js"></script>

<script src="http://ajax.googleapis.com/ajax/libs/jquery/1.11.2/jquery.min.js"></script>
<script src="library/jsbn.js"></script>
<script src="library/jsbn2.js"></script>
<script src="library/sjcl.js"></script>
<script src="library/amazon-cognito-identity.min.js"></script>
<script src="library/aws-cognito-sdk.js"></script>
<script src="https://sdk.amazonaws.com/js/aws-sdk-2.184.0.min.js" xmlns="http://www.w3.org/1999/html"></script>

<body>
    some text to show the webpage
    <!--<input type="button" value="activateLambda" onclick="lambdainvoke();">-->
    
    
    <form action="action_page.php">
        <div class="container">
            <br>UserPoolId: <input type="text" id="UserPoolId" name="UserPoolId" placeholder="Enter AWS Cognito User Pool ID"required>
            <br>ClientId: <input type="text" id="ClientId" name="ClientId" placeholder="Enter AWS Cognito Client ID"required>
            <p>Please fill in this form to create an account.</p>
            <hr>
            <br>AWS Cognito Username</br></label>
            <input type="text" placeholder="Enter UserName" id="username" name="username" required>
            <br>AWS Cognito Password</br></label>
            <input type="password" placeholder="Enter Password" id="password" name="psw" required>
            <br>
            <input type="button" value="login" onclick="login();">
            <p id="p1">please Sign In</p>
            <p id="p2">Token:</p>
            <!-- <p id="token">Your token will apear here when it is ready!</p> -->
            <textarea id="token" rows="20" cols="30">Your token will apear here when it is ready!</textarea>
        </div>
    </form>
    <script>
        let UserPoolId = getCookie("UserPoolId")
        let ClientId = getCookie("ClientId")
        console.log("Getting Cookie for Cognito UserPoolId:",UserPoolId)
        console.log("Getting Cookie for Cognito ClientId:",ClientId)
        document.getElementById("UserPoolId").value=UserPoolId;
        document.getElementById("ClientId").value=ClientId;
        function setCookie(name, value, days) {
            var expires = "";
            if (days) {
                var date = new Date();
                date.setTime(date.getTime() + (days * 24 * 60 * 60 * 1000));
                expires = "; expires=" + date.toUTCString();
            }
            document.cookie = name + "=" + (value || "") + expires + "; path=/";
        }

        function getCookie(name) {
            var nameEQ = name + "=";
            var ca = document.cookie.split(';');
            for (var i = 0; i < ca.length; i++) {
                var c = ca[i];
                while (c.charAt(0) == ' ') c = c.substring(1, c.length);
                if (c.indexOf(nameEQ) == 0) return c.substring(nameEQ.length, c.length);
            }
            return null;
        }
        function login() {
            document.getElementById("p1").innerHTML = "Logging in, please wait";
            var username = document.getElementById("username").value;
            var password = document.getElementById("password").value;
            let UserPoolId = document.getElementById("UserPoolId").value;
            let ClientId = document.getElementById("ClientId").value;
            setCookie("UserPoolId",UserPoolId,1)
            setCookie("ClientId",ClientId,1)
            var poolData = {
                UserPoolId : UserPoolId, // Your user pool id here
                ClientId : ClientId // Your client id here
            };
            var userPool = new AmazonCognitoIdentity.CognitoUserPool(poolData);
            var authenticationDetails = new AmazonCognitoIdentity.AuthenticationDetails({
                Username: username,
                Password: password
            });
            let authData = {
                Username: username,
                Password: password
            };

            let userData = {
                Username: username,
                Pool: userPool
            };
    
            let cognitoUser = new AmazonCognitoIdentity.CognitoUser(userData);
    
            cognitoUser.authenticateUser(authenticationDetails, {
                onSuccess: (result) => {
                    document.getElementById("p1").innerHTML = "You are logged in";
                    hold = result;
                    //console.log(cognitoUser);
                    idToken = cognitoUser.signInUserSession.idToken.jwtToken
                    document.getElementById("token").innerHTML = idToken;
                    console.log("Cognito Token:\n"+idToken)
                    var apigClient = apigClientFactory.newClient({
                        sessionToken: 'SESSION_TOKEN', //OPTIONAL: If you are using temporary credentials you must include the session token
                        region: 'eu-west-1' // OPTIONAL: The region where the API is deployed, by default this parameter is set to us-east-1
                    });
                },
                onFailure: (err) => {
                    document.getElementById("p1").innerHTML = "Login failed";
                    console.log(err);
                }
            });
    
    
            var apigClient = apigClientFactory.newClient({
                accessKey: 'ACCESS_KEY',
                secretKey: 'SECRET_KEY',
                sessionToken: 'SESSION_TOKEN', //OPTIONAL: If you are using temporary credentials you must include the session token
                region: 'eu-west-1' // OPTIONAL: The region where the API is deployed, by default this parameter is set to us-east-1
            });
    
        }
    </script>
</body>